(window.webpackJsonp=window.webpackJsonp||[]).push([["a1f3"],{DpsK:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return R});a("MaXC");var n=a("4IMT"),r=a.n(n),l=(a("cUip"),a("iJl9")),i=a.n(l),c=(a("7kJ1"),a("qPIi")),o=a.n(c),u=(a("tL+A"),a("QpBz")),d=a.n(u),s=(a("fwXI"),a("CC+v")),f=a.n(s),p=a("0iUn"),h=a("sLSF"),m=a("MI3g"),b=a("a7VT"),v=a("AT/M"),g=a("Tit0"),y=a("q1tI"),E=a.n(y),S=a("HgRd"),w=a("OLV9"),k=a("mVpe"),x=a.n(k),R=function(e){function t(e){var a;Object(p.default)(this,t),(a=Object(m.default)(this,Object(b.default)(t).call(this,e))).tableRef=Object(y.createRef)(),a.dialogExportRef=Object(y.createRef)(),a.state={paySubmit:!1};return["handleSearch","handleBatchPay","handleExport"].forEach(function(e){return a[e]=a[e].bind(Object(v.default)(a))}),a}return Object(g.default)(t,e),Object(h.default)(t,[{key:"handleChangeStatus",value:function(e){this.tableRef.current&&this.tableRef.current.reload({page:1,condition:{status:e}})}},{key:"handleSearch",value:function(e){this.tableRef.current.reload({condition:{order_sn:e}})}},{key:"handleBatchPay",value:function(){var e=this;this.setState({paySubmit:!0}),S.a.get("/order/getpay").then(function(t){if(e.setState({paySubmit:!1}),0==t.errcode)if(t.data.length){var a=t.data.reduce(function(e,t){return e+t.amount},0);f.a.confirm({title:"您确认要付款吗？",content:E.a.createElement("div",null,"找到",t.data.length,"个待付款订单，支付金额 ",E.a.createElement("span",{className:"text-warning"},a)," 元"),onOk:function(){e.setState({paySubmit:!0}),S.a.post("/order/pay",{id:t.data.map(function(e){return e.id})}).then(function(t){e.setState({paySubmit:!1}),0==t.errcode&&(d.a.success("批量付款成功"),e.tableRef.current.reload())})}})}else d.a.error("未找到待付款订单")})}},{key:"handleExport",value:function(){S.a.post("/order/exportUserLogis").then(function(e){0===e.errcode&&window.open("".concat(x.a.production.url.api).concat(e.data.filepath))})}},{key:"render",value:function(){var e=this,t=this.state.paySubmit;return E.a.createElement("div",{className:"page-layout-center"},E.a.createElement(w.b,{ref:this.dialogExportRef}),E.a.createElement(o.a.Group,{defaultValue:"all",onChange:function(t){var a=t.target.value;e.handleChangeStatus("all"==a?null:a)},style:{marginBottom:"20px"}},[{value:"all",label:"全部订单"},{value:"audit",label:"待审核"},{value:"waitpay",label:"待付款"},{value:"pending",label:"等待打印"},{value:"success",label:"已打印"},{value:"waitsend",label:"待发货"},{value:"send",label:"已发货"}].map(function(e){return E.a.createElement(o.a.Button,{key:e.value,value:e.value},e.label)})),E.a.createElement("div",{className:"form-condition"},E.a.createElement(i.a.Search,{onSearch:this.handleSearch,placeholder:"搜索订单号"}),E.a.createElement(r.a,{loading:t,style:{marginLeft:"15px"},type:"primary",onClick:this.handleBatchPay},"批量付款"),E.a.createElement(r.a,{style:{marginLeft:"15px"},onClick:this.handleExport},"导出物流信息"),E.a.createElement("a",{style:{marginLeft:"15px"},onClick:function(){e.dialogExportRef.current&&e.dialogExportRef.current.open()}},"物流信息导出历史")),E.a.createElement(w.e,{action:"/order/userlist",ref:this.tableRef}))}}]),t}(y.Component)},Upp2:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order",function(){var e=a("DpsK");return{page:e.default||e}}])}},[["Upp2","5d41","9da1","ad9d"]]]);