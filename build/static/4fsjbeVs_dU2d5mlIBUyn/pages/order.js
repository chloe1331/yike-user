(window.webpackJsonp=window.webpackJsonp||[]).push([["a1f3"],{DpsK:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return L});a("MaXC");var n=a("4IMT"),r=a.n(n),l=(a("cUip"),a("iJl9")),i=a.n(l),o=(a("7kJ1"),a("qPIi")),c=a.n(o),u=(a("tL+A"),a("QpBz")),d=a.n(u),s=(a("fwXI"),a("CC+v")),f=a.n(s),p=a("vYYK"),h=a("0iUn"),m=a("sLSF"),g=a("MI3g"),b=a("a7VT"),v=a("AT/M"),y=a("Tit0"),E=a("q1tI"),S=a.n(E),w=a("HgRd"),x=a("OLV9"),k=a("mVpe"),R=a.n(k),L=function(e){function t(e){var a;Object(h.default)(this,t),(a=Object(g.default)(this,Object(b.default)(t).call(this,e))).tableRef=Object(E.createRef)(),a.dialogExportRef=Object(E.createRef)(),a.state={paySubmit:!1,logisLoading:!1};return["handleSearch","handleBatchPay","handleExport"].forEach(function(e){return a[e]=a[e].bind(Object(v.default)(a))}),a}return Object(y.default)(t,e),Object(m.default)(t,[{key:"handleChangeStatus",value:function(e){this.tableRef.current&&this.tableRef.current.reload({page:1,condition:{status:e}})}},{key:"handleSearch",value:function(e,t){this.tableRef.current.reload({condition:Object(p.a)({},e,t)})}},{key:"handleBatchPay",value:function(){var e=this;this.setState({paySubmit:!0}),w.a.get("/order/getpay").then(function(t){if(e.setState({paySubmit:!1}),0==t.errcode)if(t.data.length){var a=t.data.reduce(function(e,t){return e+t.amount},0);f.a.confirm({title:"您确认要付款吗？",content:S.a.createElement("div",null,"找到",t.data.length,"个待付款订单，支付金额 ",S.a.createElement("span",{className:"text-warning"},a)," 元"),onOk:function(){e.setState({paySubmit:!0}),w.a.post("/order/pay",{id:t.data.map(function(e){return e.id})}).then(function(t){e.setState({paySubmit:!1}),0==t.errcode&&(d.a.success("批量付款成功"),e.tableRef.current.reload())})}})}else d.a.error("未找到待付款订单")})}},{key:"handleExport",value:function(){var e=this;this.setState({logisLoading:!0},function(){w.a.post("/order/exportUserLogis").then(function(t){0===t.errcode&&window.open("".concat(R.a.production.url.api).concat(t.data.filepath)),e.setState({logisLoading:!1})})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.paySubmit,n=t.logisLoading;return S.a.createElement("div",{className:"page-layout-center"},S.a.createElement(x.b,{ref:this.dialogExportRef}),S.a.createElement(c.a.Group,{defaultValue:"all",onChange:function(t){var a=t.target.value;e.handleChangeStatus("all"==a?null:a)},style:{marginBottom:"20px"}},[{value:"all",label:"全部订单"},{value:"audit",label:"待审核"},{value:"waitpay",label:"待付款"},{value:"pending",label:"等待打印"},{value:"success",label:"已打印"},{value:"waitsend",label:"待发货"},{value:"send",label:"已发货"}].map(function(e){return S.a.createElement(c.a.Button,{key:e.value,value:e.value},e.label)})),S.a.createElement("div",{className:"form-condition"},S.a.createElement(i.a.Search,{onSearch:function(t){return e.handleSearch("order_sn",t)},placeholder:"搜索订单号"}),S.a.createElement(i.a.Search,{style:{marginLeft:"15px"},onSearch:function(t){return e.handleSearch("express_sn",t)},placeholder:"搜索运单号"}),S.a.createElement(r.a,{loading:a,style:{marginLeft:"15px"},type:"primary",onClick:this.handleBatchPay},"批量付款"),S.a.createElement(r.a,{style:{marginLeft:"15px"},onClick:this.handleExport,loading:n},"导出物流信息"),S.a.createElement("a",{style:{marginLeft:"15px"},onClick:function(){e.dialogExportRef.current&&e.dialogExportRef.current.open()}},"物流信息导出历史")),S.a.createElement(x.f,{action:"/order/userlist",ref:this.tableRef}))}}]),t}(E.Component)},Upp2:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order",function(){var e=a("DpsK");return{page:e.default||e}}])}},[["Upp2","5d41","9da1","ad9d"]]]);